<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
<!--		<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js'></script>
		<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js'></script>
		-->
  <script src="./js/jquery-ui-1.9.0.custom/js/jquery-1.8.2.js"></script>
  <script src="./js/jquery-ui-1.9.0.custom/js/jquery-ui-1.9.0.custom.js"></script>
<script src="./js/mbostock-d3-44e4620/d3.v2.js"></script>
		<!--
  <script src="http://code.jquery.com/jquery-latest.js"></script>
		<script type='text/javascript' src='../plugins/savingsestimator/js/underscore.js'></script>
		<script type='text/javascript' src='../plugins/savingsestimator/js/backbone.js'></script>
		-->
		<script>
			var mysite = "AGR";
			var elevationArray = new Array();
			var noElevation = 998877.000;
			$(document).ready(function(){
							//alert("good");
				$("button").click(function(){
					myurl = 'http://www.usbr.gov/gp-bin/arcread.pl?jsonp=?';
					$.getJSON(myurl,
						{
							st : mysite,
							by : "2012",
							bm : "1",
							bd : "1",
							ey : "2012",
							em : "1",
							ed : "3",
							pa : "FB"
						},
						
						function (data) {
						//	console.log(data);
							for (var i = 0; i < data.SITE.DATA.length; i++) {
								var elevation = parseFloat(data.SITE.DATA[i].FB);
								//if( elevation < 2200 ) { alert(JSON.stringify(data.AGR[i])) }
								if ((elevation != noElevation) && (elevation != 0)) {
									var day = new Date(Date.parse(data.SITE.DATA[i].DATE));
									elevationArray.push({"day" : day,"elevation" : elevation});
								}
							}
					//		console.log(elevationArray);
				//			$("div").html(data.AGR[1].FB);
							//$("div#thing1").html(JSON.stringify(data));
							$( "#minDate" ).datepicker({ minDate: -20, maxDate: "+1M +10D" });
							$("div#thing1").html($("#thing3").html());
						//	$("div#thing2").html(JSON.stringify(elevationArray));
							//$("div#thing1").html($("#thing3").html());
						});
					});
				});
</script>
<style>

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.area {
  fill: steelblue;
}

</style>
<!--
<script src="mbostock-d3-44e4620/d3.v2.js"></script>
<script src="http://d3js.org/d3.v3.js"></script>
-->
	</head>
	<body>
<select id="parameterSelect">
	<option value="NONE"> --Common Parameters-- </option>
	<option value="QD"> QD     Daily Mean Total Discharge (cfs) </option>
	<option value="PU"> PU     Total Water Year Precipitation (inches) </option>
	<option value="GD"> GD     Daily Mean Gage Height (feet) </option>
	<option value="MX"> MX     Daily Maximum Air Temperature (degrees F) </option>
	<option value="MN"> MN     Daily Minimum Air Temperature (degrees F) </option>
	<option value="MM"> MM     Daily Mean Air Temperature (degrees F) </option>
	<option value="HH"> HH     Gage Height Shift (feet) </option>
	<option value="SE"> SE     Snow Water Equivalent (inches) </option>
	<option value="PP"> PP     Total Precipitation (inches per day) </option>
	<option value="QJ"> QJ     Daily Mean Canal Discharge (cfs) </option>
	<option value="GJ"> GJ     Daily Mean Canal Gage Height (feet) </option>
	<option value="FB"> FB     Reservoir Forebay Elevation (feet) </option>
	<option value="AF"> AF     Reservoir Storage Content (acre-feet) </option>
	<option value="AF_AVG"> AF_AVG Reservoir Historic Average Content (acre-feet) </option>
	<option value="IN"> IN     Daily Mean Computed Inflow (cfs) </option>
	<option value="SE_PCT"> SE_PCT Snow Water Equivalent Percent of Average (percent) </option>
	<option value="WD"> WD     Wind Direction (degrees) </option>
	<option value="UA"> UA     Daily Mean Wind Speed (mph) </option>
	<option value="HJ"> HJ     Canal Shift (feet) </option>
	<option value="QRD"> QRD    Daily Mean River Discharge (cfs) </option>
	<option value="WY"> WY     Daily Mean Water Temperature (degrees C) </option>
	<option value="WN"> WN     Daily Minimum Water Temperature (degrees C) </option>
	<option value="WM"> WM     Daily Maximum Water Temperature (degrees C) </option>
	<option value="TA"> TA     Mean Daily Humidity (percent) </option>
	<option value="WZ"> WZ     Daily Mean Water Temperature (degrees F) </option>
	<option value="WL"> WL     Daily Minimum Water Temperature (degrees F) </option>
	<option value="WK"> WK     Daily Maximum Water Temperature (degrees F) </option>
	<option value="SR"> SR     Solar Radiation (Langleys per day) </option>
	<option value="SE_AVG"> SE_AVG Snow Water Equivalent Average (inches) </option>
	<option value="YM"> YM     Daily Mean Air Temperature, Dew Point (degrees F) </option>
	<option value="TG"> TG     Growing Degree Days (degrees F) </option>
	<option value="WR"> WR     Daily Wind Run (miles) </option>
</select>
	<div id="thing4">
<script id="thing3" type="text/html">
<script id="thing5">

var margin = {top: 20, right: 20, bottom: 30, left: 50},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var parseDate = d3.time.format("%d-%b-%y").parse;

var x = d3.time.scale()
    .range([0, width]);

var y = d3.scale.linear()
    .range([height, 0]);

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");

var area = d3.svg.area()
    .x(function(d) { return x(d.day); })
    .y0(height)
    .y1(function(d) { return y(d.elevation); });

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

//d3.entries(elevationArray)
/*
d3.tsv("data.tsv", function(error, data) {
  data.forEach(function(d) {
  	console.log(JSON.stringify(d));
    d.date = parseDate(d.date);
    d.close = +d.close;
  	console.log(JSON.stringify(d));
  });

function(error, elevationArray) {
  elevationArray.forEach(function(d) {
    d.date = parseDate(d.date);
    d.close = +d.close;
  });
*/

//  x.domain(d3.extent(data, function(d) { return d.date; }));
//  y.domain([0, d3.max(data, function(d) { return d.close; })]);
  x.domain(d3.extent(elevationArray, function(d) {return d.day;}));
  y.domain(d3.extent(elevationArray, function(d) {return d.elevation;}));

  svg.append("path")
      .datum(elevationArray)
      .attr("class", "area")
      .attr("d", area);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
//      .attr("transform", "rotate(-90)")
    //  .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Price ($)");
//}
//);
</script>
</script>
</div>		
<div id="thing10" >
	<label for="myDate">When are you available this summer?</label>
	<input type="text" id="minDate" />
</div>		
<div id="thing1" >
	<p>stuff</p>
</div>
<div id="thing2"><p>stuff</p></div>
<button>Change Content</button>
	</body>
</html>
